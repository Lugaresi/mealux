# Description:  The ultimate music player for Linux 
# URL:          http://deadbeef.sourceforge.net/
# Maintainer:   Stuka
# Depends on:   faad2 libmad libsamplerate pulseaudio jansson libdispatch

name=deadbeef
version=1.9.2
release=1
source=(https://sourceforge.net/projects/deadbeef/files/travis/linux/${version}/deadbeef-${version}.tar.bz2
	7b52bac5a69abeab6d8b6601fd9e36803842d9c1.diff)

build() {
  cd $name-$version

  # Fix building with FFMpeg 5.0+
  patch -p1 -i $SRC/7b52bac5a69abeab6d8b6601fd9e36803842d9c1.diff

#  ./autogen.sh
  CC=clang CXX=clang++ \
  ./configure --prefix=/usr --mandir=/usr/man \
      --enable-alsa --enable-gtk2 --enable-vfs-curl --enable-supereq \
      --enable-mad --enable-vorbis --enable-sndfile --enable-hotkeys \
      --enable-mms --enable-m3u --enable-converter --enable-artwork \
      --enable-wavpack --enable-musepack --enable-cdda --enable-ffap \
      --enable-opus --enable-ffmpeg --enable-hotkeys --enable-notify \
      --enable-dca --enable-aac --enable-mono2stereo --enable-alac --enable-wma \
      --disable-static --disable-nls --disable-nullout --disable-oss \
      --disable-coreaudio --disable-gtk3 --disable-lfm --disable-sid --disable-vtx \

  make
  make install DESTDIR=$PKG
  rm -rf $PKG/usr/share/locale
  rm -rf $PKG/usr/share/doc
}
