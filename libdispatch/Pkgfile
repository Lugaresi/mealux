# Description: The libdispatch Project, (a.k.a. Grand Central Dispatch), for concurrency on multicore hardware.
# URL:         http://libhx.sourceforge.net/
# Maintainer:  Lugaresi
# Depends on: clang ninja 

name=libdispatch
#version=5.5
version=2022-06-02-a
release=1
#source=(https://github.com/apple/swift-corelibs-libdispatch/archive/refs/tags/swift-$version-RELEASE.tar.gz)
source=(https://github.com/apple/swift-corelibs-libdispatch/archive/refs/tags/swift-DEVELOPMENT-SNAPSHOT-$version.tar.gz)

build() {
#    cd swift-corelibs-libdispatch-swift-$version-RELEASE
    cd swift-corelibs-libdispatch-swift-DEVELOPMENT-SNAPSHOT-$version
    mkdir build && cd build
    cmake -G Ninja -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ \
    -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_INSTALL_PREFIX=/usr ..
    ninja
    DESTDIR=$PKG ninja install
}
